---
title: "Demonstration of the correlation generated by similar durations"
output: 
    github_document: default
---

Generate pairs of random time-series and correlate the abs(slope). Time-series have a random length 3 to 100 steps.
```{r}
n <- 1000
dat <- data.frame(duration = sample(3:100, n, replace=TRUE), slope1 = NA_real_, slope2 = NA_real_)
dat5 <- data.frame(duration = rep(5, n), slope1 = NA_real_, slope2 = NA_real_) # fixed length
dat20 <- data.frame(duration = rep(20, n), slope1 = NA_real_, slope2 = NA_real_) # fixed length
for(i in 1:n){
    dat$slope1[i] <- coef(lm(I(rnorm(dat$duration[i])) ~ I(1:dat$duration[i])))[2]
    dat$slope2[i] <- coef(lm(I(rnorm(dat$duration[i])) ~ I(1:dat$duration[i])))[2]
    dat$slope3[i] <- coef(lm(I(runif(dat$duration[i])) ~ I(1:dat$duration[i])))[2] # draw from uniform 0-1

    dat5$slope1[i] <- coef(lm(I(rnorm(dat5$duration[i])) ~ I(1:dat5$duration[i])))[2]
    dat5$slope2[i] <- coef(lm(I(rnorm(dat5$duration[i])) ~ I(1:dat5$duration[i])))[2]
    dat5$slope3[i] <- coef(lm(I(runif(dat5$duration[i])) ~ I(1:dat5$duration[i])))[2] # draw from uniform 0-1

    dat20$slope1[i] <- coef(lm(I(rnorm(dat20$duration[i])) ~ I(1:dat20$duration[i])))[2]
    dat20$slope2[i] <- coef(lm(I(rnorm(dat20$duration[i])) ~ I(1:dat20$duration[i])))[2]
    dat20$slope3[i] <- coef(lm(I(runif(dat20$duration[i])) ~ I(1:dat20$duration[i])))[2] # draw from uniform 0-1
}
```


# Plot the slopes
```{r}

plot(dat$slope1, dat$slope2)
plot(abs(dat$slope1), abs(dat$slope2))
plot(abs(dat$slope1), abs(dat$slope3))

plot(dat5$slope1, dat5$slope2)
plot(abs(dat5$slope1), abs(dat5$slope2))
plot(abs(dat5$slope1), abs(dat5$slope3))

plot(dat20$slope1, dat20$slope2)
plot(abs(dat20$slope1), abs(dat20$slope2))
plot(abs(dat20$slope1), abs(dat20$slope3))

```

# Correlation of variable durations
Notice the strongly significant correlation when taking the absolute value of the slope
```{r}
cor.test(dat$slope1, dat$slope2)
cor.test(abs(dat$slope1), abs(dat$slope2))
cor.test(abs(dat$slope1), abs(dat$slope2))
```

# Correlation of 5-step durations
Notice the induced correlation goes away.
```{r}
cor.test(dat5$slope1, dat5$slope2)
cor.test(abs(dat5$slope1), abs(dat5$slope2))
cor.test(abs(dat5$slope1), abs(dat5$slope2))
```

# Correlation of 20-step durations
Notice the induced correlation goes away.
```{r}
cor.test(dat20$slope1, dat20$slope2)
cor.test(abs(dat20$slope1), abs(dat20$slope2))
cor.test(abs(dat20$slope1), abs(dat20$slope2))
```


         
         